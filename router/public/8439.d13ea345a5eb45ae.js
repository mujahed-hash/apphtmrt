"use strict";(self.webpackChunkhmfront=self.webpackChunkhmfront||[]).push([[8439],{8439:(J,g,r)=>{r.r(g),r.d(g,{BuyeritemsModule:()=>S});var a=r(6814),d=r(3403),t=r(5879),v=r(7019),x=r(6627),b=r(2039),u=r(5219),C=r(5619);let _=(()=>{class n{constructor(){this.notificationsSubject=new C.X([]),this.notifications$=this.notificationsSubject.asObservable()}addNotification(i,e){this.notificationsSubject.next([...this.notificationsSubject.value,{message:i,type:e}]),setTimeout(()=>{this.removeNotification()},3e3)}removeNotification(){const i=this.notificationsSubject.value;i.shift(),this.notificationsSubject.next([...i])}static#t=this.\u0275fac=function(e){return new(e||n)};static#i=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var h=r(9560),m=r(6223),p=r(617);const y=["loadingIndicator"];function w(n,c){if(1&n&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&n){const i=c.$implicit;t.Q6J("ngClass",i.type),t.xp6(1),t.hij(" ",i.message," ")}}function M(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2).$implicit,s=t.oxw();return t.KtG(s.addProductToCart(o._id))}),t.TgZ(2,"mat-icon",22),t._uU(3,"add_shopping_cart"),t.qZA(),t._uU(4," Add to cart "),t.qZA()()}}function P(n,c){1&n&&(t.TgZ(0,"div",20)(1,"button",23)(2,"mat-icon",22),t._uU(3,"add_shopping_cart"),t.qZA(),t._uU(4," Go to cart "),t.qZA()())}const f=function(n){return["/buyer/item/view",n]};function O(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"div",10)(1,"div",11),t._UZ(2,"img",12),t.qZA(),t.TgZ(3,"div",13)(4,"p",14),t._uU(5),t.qZA(),t.TgZ(6,"button",15)(7,"mat-icon",16),t._uU(8,"visibility"),t.qZA(),t._uU(9," View"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"currency"),t.qZA(),t.TgZ(13,"div",17)(14,"p-inputNumber",18),t.NdJ("ngModelChange",function(o){t.CHM(i);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.quantities[s._id]=o)}),t.qZA()(),t.YNc(15,M,5,0,"div",19),t.YNc(16,P,5,0,"div",19),t.qZA()()}if(2&n){const i=t.oxw().$implicit,e=t.oxw();t.xp6(2),t.s9C("alt",i.prodName),t.Q6J("routerLink",t.VKq(16,f,i.customIdentifer))("src",i.images[0],t.LSH),t.xp6(3),t.Oqu(i.prodName),t.xp6(1),t.Q6J("routerLink",t.VKq(18,f,i.customIdentifer)),t.xp6(5),t.AsE("",t.xi3(12,13,i.prodPrice,"INR"),"/",i.prodSize,""),t.xp6(3),t.Q6J("ngModel",e.quantities[i._id])("showButtons",!0)("min",1)("max",i.countInStock),t.xp6(1),t.Q6J("ngIf",!i.inCart),t.xp6(1),t.Q6J("ngIf",i.inCart)}}function k(n,c){if(1&n&&(t.TgZ(0,"div",8),t.YNc(1,O,17,20,"div",9),t.qZA()),2&n){const i=c.$implicit;t.xp6(1),t.Q6J("ngIf",i.countInStock>=1)}}function Z(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"button",24,25),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.loadProducts())}),t._uU(2," Load More "),t.qZA()}if(2&n){const i=t.oxw();t.Q6J("disabled",i.isLoading)}}const B=[{path:"marketplace",component:(()=>{class n{constructor(i,e,o,s,l,N){this.supplyService=i,this.lService=e,this.el=o,this.buyerService=s,this.messageService=l,this.notificationService=N,this.products=[],this.start=0,this.limit=10,this.isLoading=!1,this.hasMoreProducts=!0,this.quantities={},this.notifications=[]}ngOnInit(){this.loggedUser=this.lService.getUserIdFromToken(),this.loadProducts(),this.token=localStorage.getItem("token"),console.log(this.quantity),this.notificationService.notifications$.subscribe(i=>{this.notifications=i}),this.products.forEach(i=>{this.quantities[i.id]=this.quantities[i.id]||1})}ngAfterViewInit(){this.initIntersectionObserver(),this.checkContentHeight()}loadProducts(){this.isLoading||!this.hasMoreProducts||(this.isLoading=!0,this.supplyService.getProducts(this.start,this.limit).subscribe(i=>{console.log(i),this.isLoading=!1,i&&Array.isArray(i.products)?(this.products=[...this.products,...i.products],this.products.forEach(e=>{this.quantities[e._id]||(this.quantities[e._id]=1)}),this.start+=this.limit,this.checkContentHeight(),this.hasMoreProducts=i.products.length===this.limit):(console.error("Unexpected response structure:",i),this.checkContentHeight())},i=>{this.isLoading=!1,console.error("Error loading products:",i)}))}checkContentHeight(){const i=this.el.nativeElement.querySelector(".items-").offsetHeight,e=window.innerHeight;this.hasMoreProducts=i>e}onResize(){this.checkContentHeight()}initIntersectionObserver(){const i=new IntersectionObserver(e=>{e[0].isIntersecting&&this.hasMoreProducts&&!this.isLoading&&this.loadProducts()},{rootMargin:"100px"});this.loadingIndicator&&i.observe(this.loadingIndicator.nativeElement)}addProductToCart(i){const e=this.quantities[i]||1;console.log(),this.buyerService.addToCart(i,e,this.token).subscribe(o=>{this.loadProducts(),this.notificationService.addNotification("Item added to cart!","success"),console.log(o)},o=>{console.error("Error adding product to cart:",o)})}static#t=this.\u0275fac=function(e){return new(e||n)(t.Y36(v.p),t.Y36(x.n),t.Y36(t.SBq),t.Y36(b.y),t.Y36(u.ez),t.Y36(_))};static#i=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-buyeritems"]],viewQuery:function(e,o){if(1&e&&t.Gf(y,5),2&e){let s;t.iGM(s=t.CRH())&&(o.loadingIndicator=s.first)}},hostBindings:function(e,o){1&e&&t.NdJ("resize",function(){return o.onResize()},!1,t.Jf7)},decls:7,vars:3,consts:[[2,"width","80%","position","fixed","z-index","5"],["style","position: relative; ","class","notification",3,"ngClass",4,"ngFor","ngForOf"],[1,"hh"],[1,"items-"],["class","item",4,"ngFor","ngForOf"],[1,"itm-btn"],["style","",3,"disabled","click",4,"ngIf"],[1,"notification",2,"position","relative",3,"ngClass"],[1,"item"],["class","sub-item","style","overflow-x: hidden;","routerLinkActive","router-link-active","style","",4,"ngIf"],["routerLinkActive","router-link-active",1,"sub-item"],[1,"img"],[3,"routerLink","src","alt"],[1,"itemName"],[2,"font-weight","bold"],[2,"width","max-content","display","flex","justify-content","center","vertical-align","middle","align-items","center","border","none","border-radius","5px","background-color","#37B7C3","color","white","padding","2px 8px",3,"routerLink"],[2,"color","white","font-size","15px","position","relative","top","0.35rem"],[1,"count"],["name","quantity","inputId","minmax","mode","decimal",3,"ngModel","showButtons","min","max","ngModelChange"],["style"," width:max-content; display: flex; align-items: center; margin-top: 0.5rem;",4,"ngIf"],[2,"width","max-content","display","flex","align-items","center","margin-top","0.5rem"],[2,"width","100%","display","flex","align-items","center","justify-content","center","border","none","border-radius","5px","background-color","#071952","color","white","padding","3px 8px",3,"click"],[2,"color","#F0DE36"],["routerLink","/buyer/cart",2,"width","100%","display","flex","align-items","center","justify-content","center","border","none","border-radius","5px","background-color","#071952","color","white","padding","3px 8px"],[3,"disabled","click"],["loadingIndicator",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,w,2,2,"div",1),t.qZA(),t.TgZ(2,"div",2)(3,"div",3),t.YNc(4,k,2,1,"div",4),t.qZA(),t.TgZ(5,"div",5),t.YNc(6,Z,3,1,"button",6),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngForOf",o.notifications),t.xp6(3),t.Q6J("ngForOf",o.products),t.xp6(2),t.Q6J("ngIf",o.hasMoreProducts&&!o.isLoading))},dependencies:[a.mk,a.sg,a.O5,d.rH,d.Od,h.Rn,m.JJ,m.On,p.Hw,a.H9],styles:[".hh[_ngcontent-%COMP%]{width:100%;justify-items:center;-ms-overflow-style:none;scrollbar-width:none;overflow-x:hidden;height:max-content;margin-bottom:5rem}.hh[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.items-[_ngcontent-%COMP%]{width:90%;height:auto}.item[_ngcontent-%COMP%]{width:25%;display:inline-block;flex-wrap:wrap;align-items:center;margin:.5rem 1rem;border-radius:8px}p-toast[_ngcontent-%COMP%]{width:20%}.img[_ngcontent-%COMP%]{margin-top:.5rem}.img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:10rem;height:7rem;margin-right:1rem;border-radius:8px;object-fit:cover}.sub-item[_ngcontent-%COMP%]{width:93%;flex:1 1 93%;display:flex;align-items:normal;vertical-align:middle;box-shadow:#3c40434d 0 1px 2px,#3c404326 0 1px 3px 1px;margin:.4rem .5rem;padding-left:1rem;padding-bottom:1rem;padding-top:.4rem}.itemName[_ngcontent-%COMP%]{margin-top:-.5rem}.notification[_ngcontent-%COMP%]{padding:15px;margin:10px;border-radius:5px;font-size:16px;color:#fff;opacity:.9;transition:opacity .5s ease-out}.success[_ngcontent-%COMP%]{background-color:#4caf50}.error[_ngcontent-%COMP%]{background-color:#f44336}.info[_ngcontent-%COMP%]{background-color:#2196f3}.count[_ngcontent-%COMP%]{width:85%}.itm-btn[_ngcontent-%COMP%]{width:100%;display:grid;justify-items:center;text-align:center;margin:0;position:relative;left:-5.8%;margin-bottom:2.4rem;margin-top:.8rem}.itm-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:max-content;background-color:#2196f3;color:#fff;font-weight:700;border:none;border-radius:7px;padding:6px 9px;margin:0;text-align:center}@media screen and (max-width: 1200px){.item[_ngcontent-%COMP%]{width:50%;display:inline-block;flex-wrap:wrap;align-items:center;margin:0rem;border-radius:8px}.items-[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 700px){.item[_ngcontent-%COMP%]{width:50}.img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:6rem;height:7rem;margin-right:2rem;border-radius:8px}.sub-item[_ngcontent-%COMP%]{padding:1rem}}@media screen and (orientation: portrait){.hh[_ngcontent-%COMP%]{height:100%;margin-bottom:0;padding-bottom:1rem}.img[_ngcontent-%COMP%]{padding-right:1rem}.img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:7.7rem;height:7rem;margin-right:2.4rem;border-radius:8px}.items-[_ngcontent-%COMP%]{margin-top:1rem;width:100%}.count[_ngcontent-%COMP%]{width:75%}.itm-btn[_ngcontent-%COMP%]{left:0}.item[_ngcontent-%COMP%]{width:100%;flex-wrap:nowrap;display:block}.sub-item[_ngcontent-%COMP%]{width:90%;padding-top:1rem;padding-bottom:1rem;box-shadow:#3c40434d 0 1px 2px,#3c404326 0 1px 3px 1px}}.sub-item[_ngcontent-%COMP%], .item[_ngcontent-%COMP%], .items-[_ngcontent-%COMP%], .hh[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none;overflow-x:hidden}.hh[_ngcontent-%COMP%]::-webkit-scrollbar, .sub-item[_ngcontent-%COMP%]::-webkit-scrollbar, .item[_ngcontent-%COMP%]::-webkit-scrollbar, .items-[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"]})}return n})()}];let T=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#i=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(B),d.Bz]})}return n})();var A=r(6451),I=r(707);let S=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#i=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[u.ez],imports:[a.ez,T,h.L$,m.u5,p.Ps,A.EV,I.hJ]})}return n})()}}]);